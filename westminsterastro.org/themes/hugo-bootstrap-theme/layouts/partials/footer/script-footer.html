<!-- JavaScript and dependencies -->

{{ $bootstrap := resources.Get "js/bootstrap/bootstrap.bundle.min.js" }}
{{ $js := resources.Get "js/main.js" }}

{{ if eq (hugo.Environment) "development" -}}
  {{ if .Site.Params.options.bootStrapJs -}}
    <script src="{{ $bootstrap.RelPermalink }}" defer></script>
  {{ end -}}
  {{ with $js }}
    <script src="{{ .RelPermalink }}" defer></script>
  {{ end -}}
{{ else -}}  
  {{ if .Site.Params.options.bootStrapJs -}}
    {{ $bootstrap := $bootstrap | fingerprint "sha256" -}}
    <script src="{{ $bootstrap.RelPermalink }}" integrity="{{ $bootstrap.Data.Integrity }}" crossorigin="anonymous" defer></script>
  {{ end -}}
  {{ with $js }}
    {{ $js := . | minify | fingerprint "sha512" -}}
    <script src="{{ $js.RelPermalink }}" integrity="{{ $js.Data.Integrity }}" crossorigin="anonymous" defer></script>
  {{ end }}
  {{ partial "footer/facebook-pixel-light.html" . }}
{{end}}

<!-- Leaflet JS for maps -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" 
        integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" 
        crossorigin=""></script>

<!-- Map initialization script -->
{{ if .Site.Data.contact.map }}
{{ $mapJs := resources.Get "js/map.js" }}
{{ if eq (hugo.Environment) "development" -}}
  <script src="{{ $mapJs.RelPermalink }}"></script>
{{ else -}}
  {{ $mapJs := $mapJs | minify | fingerprint "sha512" -}}
  <script src="{{ $mapJs.RelPermalink }}" integrity="{{ $mapJs.Data.Integrity }}" crossorigin="anonymous"></script>
{{ end }}
<script>
  // Initialize the contact map
  initContactMap({{ .Site.Data.contact.map.lat }}, {{ .Site.Data.contact.map.lng }}, '{{ .Site.Data.contact.contact.address }}');
</script>
{{ end }}